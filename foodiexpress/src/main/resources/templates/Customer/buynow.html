<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Billing Area - Food Delivery</title>
<link rel="icon" type="image/png"
	href="https://img.icons8.com/external-flaticons-lineal-color-flat-icons/64/external-welcome-rage-room-flaticons-lineal-color-flat-icons.png">

<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
	rel="stylesheet">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<script>
	function increment() {
		var quantityInput = document.getElementById("quantity");
		var quantity = parseInt(quantityInput.value);
		quantityInput.value = quantity + 1;
		calculateTotal();
	}

	function decrement() {
		var quantityInput = document.getElementById("quantity");
		var quantity = parseInt(quantityInput.value);
		if (quantity > 1) {
			quantityInput.value = quantity - 1;
			calculateTotal();
		}
	}

	function calculateTotal() {
		var quantity = parseInt(document.getElementById("quantity").value);
		var price = parseFloat(document.getElementById("price").innerText);
		var total = quantity * price;
		document.getElementById("total").value = total.toFixed(2);
	}

	// Initialize total on page load
	document.addEventListener('DOMContentLoaded', calculateTotal);
</script>

<style>
body {
	background-color: #f0f2f5; /* A soft, light background */
	font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
	display: block;
	justify-content: center;
	align-items: center; /* Align to the top */
	min-height: 100vh; /* Full viewport height */
	padding: 30px 0; /* Add some padding top/bottom */
}

.main-content-wrapper {
	margin: 0 auto; max-width : 900px;
	/* Increased max-width for side-by-side layout */
	width: 100%; /* Ensure it takes full width within max-width */
	background-color: rgb(202, 169, 135); /* Dark Cream background */
	border-radius: 20px; /* More rounded corners for the main wrapper */
	box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
	/* Stronger, softer shadow */
	padding: 40px; /* More internal padding */
	justify-content: center;
	align-items: center;
	max-width: 900px;
}

.card {
	border-radius: 15px;
	box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
	/* Slightly less prominent card shadow */
	margin-bottom: 25px; /* More spacing between cards, if stacking */
	background-color: #ffffff; /* White background for internal cards */
	border: none; /* Remove default card border */
	height: 100%; /* Ensure cards in a row have equal height */
}

.billing-header {
	text-align: center;
	padding-bottom: 30px;
	color: #343a40; /* Dark text for header */
	font-size: 2.2rem;
	font-weight: 600;
}

.item-details h3 {
	color: #333;
	margin-bottom: 8px;
}

.item-details .h5 {
	color: #6c757d; /* Muted price color */
}

.quantity-control .input-group-text {
	background-color: #e9ecef;
	border-color: #ced4da;
}

.form-control[readonly] {
	background-color: #f8f9fa; /* Lighter background for readonly inputs */
	color: #495057;
	opacity: 1;
	border-color: #dee2e6;
}

textarea.form-control {
	border-radius: 10px;
}

.order-summary hr {
	border-top: 1px solid rgba(0, 0, 0, 0.08); /* Lighter dividers */
	margin: 15px 0;
}

.delivery-info p {
	margin-bottom: 0; /* Remove default margin */
	color: #495057; /* Darker text for info */
	font-size: 0.95rem;
}

.delivery-info img {
	filter: grayscale(10%); /* Slightly desaturate icons */
	margin-right: 10px;
}

/* New style for radio buttons */
.payment-options .form-check-input {
	margin-top: 0.3rem;
}

.payment-options .form-check-label {
	font-size: 1rem;
	font-weight: 500;
}

.btn-primary {
	background-color: #d9534f; /* A sophisticated reddish-orange */
	border-color: #d9534f;
	padding: 12px 35px;
	font-size: 1.1rem;
	border-radius: 30px; /* Pill-shaped button */
	transition: background-color 0.3s ease, transform 0.2s ease;
}

.btn-primary:hover {
	background-color: #c9302c; /* Slightly darker on hover */
	border-color: #c9302c;
	transform: translateY(-2px); /* Subtle lift effect */
}

.text-muted-custom {
	color: #6c757d !important;
}

.foot {
	margin-top: 30px;
	
	background-color: rgb(202, 169, 135);
}
</style>
</head>
<body>

	<div class="main-content-wrapper ">
		<h1 class="billing-header">
			<i class="fas fa-receipt me-2"></i> Billing Area
		</h1>

		<form th:action="@{/order}" th:object="${order}" method="POST">
			<div class="row">
				<div class="col-md-6 mb-4">
					<div class="card p-4">
						<h4 class="mb-3">Item Details</h4>
						<div class="row align-items-center mb-3">
							<div class="col-md-7 item-details">
								<h3 class="mb-2" th:text="${food.name}">Food Item Name</h3>
								<p class="h5 text-muted-custom">
									<img width="18" height="18"
										src="https://img.icons8.com/material-rounded/24/rupee.png"
										alt="rupee icon" /> <span id="price" class="fw-bold"
										th:text="${food.rs}">0.00</span>
								</p>
							</div>
							<div class="col-md-5 quantity-control">
								<label for="quantity" class="form-label visually-hidden">Quantity:</label>
								<div class="input-group input-group-sm">
									<button class="btn btn-outline-secondary" type="button"
										onclick="decrement()">-</button>
									<input type="text" class="form-control text-center"
										id="quantity" th:value="1" name="quantity" readonly>
									<button class="btn btn-outline-secondary" type="button"
										onclick="increment()">+</button>
								</div>
							</div>
						</div>
						<hr>
						<div class="mt-3">
							<label for="comment" class="form-label">Add a note for
								the restaurant:</label>
							<textarea class="form-control" id="comment" rows="3"
								placeholder="E.g., No onions, extra spicy, or allergy information..."
								name="comment" th:field="*{comment}"></textarea>
						</div>

						<br>
						<h4 class="mb-3">From</h4>
						<div class="delivery-info mb-4">
							<div class="d-flex align-items-center mb-2">
								<img width="22" height="22"
									src="https://as2.ftcdn.net/v2/jpg/02/38/67/23/1000_F_238672311_IY5p9PT4h9pwsEhf1ikdXBCH3fC6wDS5.jpg"
									alt="delivery time icon" />

								<p class="mb-0" th:text="${food.rName}"><p>
								</p>
								,
								</p><p style="margin-left: 5px" class="mb-0"
									th:text="${food.rAddress}"></p>
							</div>


						</div>
					</div>
				</div>

				<div class="col-md-6 mb-4">
					<div class="card p-4">
						<h4 class="mb-3">Delivery Information</h4>
						<div class="delivery-info mb-4">
							<div class="d-flex align-items-center mb-2">
								<img width="22" height="22"
									src="https://img.icons8.com/cotton/64/stopwatch.png"
									alt="delivery time icon" />
								<p class="mb-0">Delivery in 30 mins</p>
							</div>
							<hr>
							<div class="d-flex align-items-center mb-2">
								<img width="22" height="22"
									src="https://img.icons8.com/fluency-systems-regular/48/home--v1.png"
									alt="delivery address icon" />
								<p class="mb-0" th:text="${ctm.address}">Customer Address</p>
							</div>
							<hr>
							<div class="d-flex align-items-center mb-2">
								<img width="22" height="22"
									src="https://img.icons8.com/ios/50/phone--v1.png"
									alt="contact phone icon" />
								<p class="mb-0" th:text="${ctm.phone} + ', ' + ${ctm.altPhone}">Customer
									Phone</p>
							</div>
						</div>

						<h4 class="mb-3">Payment Details</h4>
						<div class="mb-3">
							<label for="total" class="form-label">Total Price:</label> <input
								type="text" class="form-control" id="total"
								th:value="${food.rs} + '.00'" readonly name="price">
						</div>
						<div class="mb-3 payment-options">
							<div class="mb-3 payment-options">
								<label class="form-label d-block">Choose Payment Method:</label>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio"
										name="payment" id="paymentOnline" value="Online"
										onclick="togglePaymentOptions()"> <label
										class="form-check-label" for="paymentOnline">Online
										Payment</label>
								</div>
								<div class="form-check form-check-inline">
									<input class="form-check-input" type="radio"
										 id="paymentCOD" 
										onclick="togglePaymentOptions()" th:value="COD" name="payment"> <label
										class="form-check-label" for="paymentCOD">Cash On
										Delivery (COD)</label>
								</div>
							</div>

							<!-- QR Code Section (Initially Hidden) -->
							<div id="qr-container" style="display: none; text-align: center;">
								<h4>Scan & Pay</h4>
								<img id="qr-image" style="width: 150px; height: 150px;"
									src="https://i.pinimg.com/originals/8d/3e/9f/8d3e9f23fdcc10dabe15567c0c8f612e.jpg"
									alt="QR Code">
								<p id="qr-details"></p>
							</div>

							<!-- Confirm Payment Button (Hidden by Default) -->
							<div class="text-center mt-4">
								<button id="confirmPaymentBtn" class="btn btn-success"
									style="display: none;" onclick="enablePlaceOrder()">Confirm
									Payment</button>
							</div>



							<script>
								function togglePaymentOptions() {
									let qrContainer = document
											.getElementById("qr-container");
									let confirmPaymentBtn = document
											.getElementById("confirmPaymentBtn");
									let placeOrderBtn = document
											.getElementById("placeOrderBtn");

									if (document
											.getElementById("paymentOnline").checked) {
										qrContainer.style.display = "block";
										confirmPaymentBtn.style.display = "block"; // Show Confirm Payment button
										placeOrderBtn.disabled = true; // Disable Place Order until payment is confirmed
									} else {
										qrContainer.style.display = "none";
										confirmPaymentBtn.style.display = "none";
										placeOrderBtn.disabled = false; // Enable Place Order for COD
									}
								}

								function enablePlaceOrder() {
									document.getElementById("placeOrderBtn").disabled = false; // Enable Place Order after confirmation
									alert("Payment Confirmed! You can now place your order.");
								}
							</script>
						</div>
					</div>
				</div>
			</div>




			<input type="hidden" th:value="${food.name}" name="name"> <input
				type="hidden" th:value="${food.rName}" name="rName"> <input
				type="hidden" th:value="${ctm.name}" name="cName"> <input
				type="hidden" th:value="${ctm.phone}" name="cPhone"> <input
				type="hidden" th:value="${ctm.altPhone}" name="cAltPhone"> <input
				type="hidden" th:value="${ctm.address}" name="cAddress"> <input
				type="hidden" th:value="${ctm.email}" name="cEmail"> <input
				type="hidden" th:value="${food.fImg}" name="fImg"> <input
				type="hidden" th:value="1" name="flag"> <input type="hidden"
				th:value="0" name="tFlag"> <input type="hidden" name="dEmail"> <input
				type="hidden" th:value="${food.rAddress}" name="rAddress">
				

			<!-- Place Order Button (Initially Disabled) -->
			<div class="text-center mt-4 ">
				<button id="placeOrderBtn" type="submit" class="btn btn-primary"
					disabled>Place Order</button>
			</div>


		</form>



	</div>
	<footer class=" foot text-center py-3 text-white  w-100">

		<div class="container  ">
			<p class="mb-2">&copy; 2025 Foodie Express. All Rights Reserved.</p>

		</div>
	</footer>

	<script src="https://kit.fontawesome.com/a076d05399.js"
		crossorigin="anonymous"></script>
</body>

<script>
  window.addEventListener('pageshow' , function (event) {
		if(event.persisted || (window.performance && window.performance.navigation.type === 2)){
			window.location.reload();
		}
});
  </script>
</html>